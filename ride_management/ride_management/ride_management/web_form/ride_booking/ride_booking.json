{
 "allow_comments": 0,
 "allow_delete": 0,
 "allow_edit": 0,
 "allow_incomplete": 0,
 "allow_multiple": 0,
 "allow_print": 0,
 "anonymous": 0,
 "apply_document_permissions": 0,
 "button_label": "Submit",
 "client_script": "frappe.ui.form.on('Ride Booking', {\r\n    onload: function (frm) {\r\n        // Fetch the price_per_km from Ride App Settings\r\n        frappe.call({\r\n            method: 'frappe.client.get_value',\r\n            args: {\r\n                doctype: 'Ride App Settings',\r\n                fieldname: 'price_per_km'\r\n            },\r\n            callback: function (response) {\r\n                if (response.message) {\r\n                    // Set the fetched price_per_km value in the Ride Booking form\r\n                    frm.set_value('price_per_km', response.message.price_per_km);\r\n                }\r\n            }\r\n        });\r\n    }\r\n});\r\n\r\nfrappe.ui.form.on(\"Ride Booking Item\", {\r\n    distance_in_km: function(frm, cdt, cdn) {\r\n        // Get the current row\r\n        const row = frappe.get_doc(cdt, cdn);\r\n        const price_per_km = frm.doc.price_per_km;\r\n\r\n        // Update the amount for the current row\r\n        row.amount = row.distance_in_km * price_per_km;\r\n\r\n        // Calculate total amount\r\n        let total_amount = 0;\r\n        frm.doc.items.forEach(item => {\r\n            total_amount += item.amount || 0;\r\n        });\r\n\r\n        // Set total amount in parent document\r\n        frm.set_value('total_amount', total_amount);\r\n\r\n        // Refresh fields\r\n        frm.refresh_field(\"items\");\r\n        frm.refresh_field(\"total_amount\");\r\n    }\r\n});\r\n",
 "condition_json": "[]",
 "creation": "2024-07-25 16:39:33.804980",
 "doc_type": "Ride Booking",
 "docstatus": 0,
 "doctype": "Web Form",
 "idx": 0,
 "is_standard": 1,
 "list_columns": [],
 "login_required": 0,
 "max_attachment_size": 0,
 "modified": "2024-07-25 18:04:22.227355",
 "modified_by": "Administrator",
 "module": "Ride Management",
 "name": "ride-booking",
 "owner": "Administrator",
 "published": 1,
 "route": "ride-booking",
 "show_attachments": 0,
 "show_list": 0,
 "show_sidebar": 0,
 "title": "Ride Booking",
 "web_form_fields": [
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "section_break_gcyn",
   "fieldtype": "Section Break",
   "hidden": 0,
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "customer_name",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Customer Name",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "booking_date",
   "fieldtype": "Date",
   "hidden": 0,
   "label": "Booking Date",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "phone_number",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Phone Number",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "pickup_location",
   "fieldtype": "Small Text",
   "hidden": 0,
   "label": "Pickup Location",
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "column_break_mitn",
   "fieldtype": "Column Break",
   "hidden": 0,
   "label": "",
   "max_length": 0,
   "max_value": 0,
   "options": "INR\nUSD",
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "vehicle",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "Vehicle",
   "max_length": 0,
   "max_value": 0,
   "options": "Vehicle",
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "driver",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "Driver",
   "max_length": 0,
   "max_value": 0,
   "options": "Driver",
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "default": "",
   "fieldname": "price_per_km",
   "fieldtype": "Currency",
   "hidden": 0,
   "label": "Price Per km",
   "max_length": 0,
   "max_value": 0,
   "options": "currency",
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "currency",
   "fieldtype": "Select",
   "hidden": 0,
   "label": "Currency",
   "max_length": 0,
   "max_value": 0,
   "options": "INR\nUSD",
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "total_amount",
   "fieldtype": "Currency",
   "hidden": 0,
   "label": "Total Amount",
   "max_length": 0,
   "max_value": 0,
   "options": "currency",
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "section_break_ci2z",
   "fieldtype": "Section Break",
   "hidden": 0,
   "max_length": 0,
   "max_value": 0,
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "items",
   "fieldtype": "Table",
   "hidden": 0,
   "label": "Items",
   "max_length": 0,
   "max_value": 0,
   "options": "Ride Booking Item",
   "precision": "",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  }
 ]
}